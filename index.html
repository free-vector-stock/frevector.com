<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FREE VECTOR STOCK - Home</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 0; background: #fff; }
        header { background: #000; color: #fff; padding: 20px; text-align: center; font-size: 24px; font-weight: bold; }
        .search-container { background: #f4f4f4; padding: 20px; text-align: center; border-bottom: 1px solid #ddd; }
        #sInp { width: 80%; max-width: 600px; padding: 12px; border-radius: 25px; border: 1px solid #ccc; }
        .main { display: flex; max-width: 1400px; margin: auto; }
        .sidebar { width: 250px; padding: 20px; border-right: 1px solid #eee; }
        .content { flex: 1; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
        .card { border: 1px solid #eee; text-align: center; cursor: pointer; transition: 0.3s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .card img { width: 100%; height: 150px; object-fit: cover; }
        .pagination { margin: 30px 0; text-align: center; }
        .page-btn { padding: 10px 15px; margin: 5px; cursor: pointer; border: 1px solid #000; background: #fff; }
        .page-btn.active { background: #000; color: #fff; }
        #modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#fff; z-index:999; overflow-y:auto; }
    </style>
</head>
<body>
    <header>FREE VECTOR STOCK</header>
    <div class="search-container"><input type="text" id="sInp" placeholder="Search for vectors..."></div>
    <div class="main">
        <aside class="sidebar"><h3 id="catTitle">Categories</h3><div id="cats"></div></aside>
        <div class="content">
            <div class="grid" id="grid"></div>
            <div class="pagination" id="pager"></div>
            <hr><h3>Related Vectors (Random 20)</h3>
            <div class="grid" id="relGrid"></div>
        </div>
    </div>
    <div id="modal">
        <div style="padding:20px;"><button onclick="document.getElementById('modal').style.display='none'">‚Üê BACK</button></div>
        <div style="max-width:800px; margin:auto; text-align:center;">
            <img id="mImg" style="width:100%; border:1px solid #ddd;">
            <h1 id="mTitle"></h1>
            <button onclick="startDL('jpg')" style="padding:15px 40px; background:#000; color:#fff; cursor:pointer;">DOWNLOAD JPG</button>
            <button onclick="startDL('eps')" style="padding:15px 40px; background:#000; color:#fff; cursor:pointer; margin-left:10px;">DOWNLOAD EPS</button>
        </div>
    </div>
    <div id="wait" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.95); z-index:1000; text-align:center; padding-top:100px;">
        <h2>Preparing Download...</h2><div id="timer" style="font-size:80px; color:red; font-weight:bold;">10</div>
    </div>

    <script>
        const U="free-vector-stock", R="free-vector-stock";
        let all=[], filtered=[], page=1, limit=10, active=null;

        async function init() {
            const res = await fetch(`https://api.github.com/repos/${U}/${R}/contents/assets`);
            const data = await res.json();
            const map = {};
            data.forEach(f => {
                const id = f.name.split('.')[0];
                if(!map[id]) map[id] = {id, jpg:null, eps:null};
                if(f.name.endsWith('.jpg') || f.name.endsWith('.jpeg')) map[id].jpg = f.download_url;
                if(f.name.endsWith('.eps')) map[id].eps = f.download_url;
            });
            all = Object.values(map).filter(x => x.jpg);
            filtered = [...all];
            render(1);
            renderRel();
            
            // Kategori Listesi
            const cDiv = document.getElementById('cats');
            ["Abstract", "Nature", "Business", "Food", "Technology"].forEach(c => {
                const btn = document.createElement('div');
                btn.style.cssText = "padding:10px; cursor:pointer; border-bottom:1px solid #f4f4f4;";
                btn.innerText = c;
                btn.onclick = () => { filtered = all.filter(x => x.id.toLowerCase().includes(c.toLowerCase())); render(1); };
                cDiv.appendChild(btn);
            });
        }

        function render(p) {
            page = p;
            const start = (p-1)*limit;
            const items = filtered.slice(start, start+limit);
            const g = document.getElementById('grid'); g.innerHTML = "";
            items.forEach(item => {
                const d = document.createElement('div'); d.className='card';
                d.innerHTML = `<img src="${item.jpg}"><div>${item.id}</div>`;
                d.onclick = () => { active=item; document.getElementById('mImg').src=item.jpg; document.getElementById('mTitle').innerText=item.id; document.getElementById('modal').style.display='block'; };
                g.appendChild(d);
            });
            
            const pager = document.getElementById('pager'); pager.innerHTML = "";
            for(let i=1; i<=Math.ceil(filtered.length/limit); i++) {
                const btn = document.createElement('button'); btn.className = `page-btn ${i===page?'active':''}`;
                btn.innerText=i; btn.onclick=()=>render(i); pager.appendChild(btn);
            }
        }

        function renderRel() {
            const rel = [...all].sort(()=>0.5-Math.random()).slice(0,20);
            const rg = document.getElementById('relGrid');
            rel.forEach(item => {
                const d = document.createElement('div'); d.className='card';
                d.innerHTML = `<img src="${item.jpg}"><div>${item.id}</div>`;
                rg.appendChild(d);
            });
        }

        document.getElementById('sInp').oninput = (e) => {
            filtered = all.filter(x => x.id.toLowerCase().includes(e.target.value.toLowerCase()));
            render(1);
        };

        async function startDL(type) {
            const url = active[type]; if(!url) return alert("File not found!");
            document.getElementById('wait').style.display='block';
            let c = 10;
            const timer = setInterval(async () => {
                c--; document.getElementById('timer').innerText = c;
                if(c <= 0) {
                    clearInterval(timer); document.getElementById('wait').style.display='none';
                    const r = await fetch(url); const blob = await r.blob();
                    const bUrl = window.URL.createObjectURL(blob);
                    const a = document.createElement('a'); a.href = bUrl; a.download = `${active.id}.${type}`;
                    document.body.appendChild(a); a.click(); a.remove();
                }
            }, 1000);
        }
        init();
    </script>
</body>
</html>
