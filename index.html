<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FREE VECTOR STOCK | Premium Assets</title>
    <style>
        :root { --black: #000; --white: #fff; --grey: #f4f4f4; }
        * { box-sizing: border-box; font-family: sans-serif; }
        body { margin: 0; background: var(--white); }
        .header { background: var(--black); color: #fff; padding: 40px; text-align: center; }
        .logo { font-size: 32px; font-weight: 900; text-decoration: none; color: #fff; }
        .search-container { padding: 40px; text-align: center; border-bottom: 1px solid #eee; }
        #q { width: 100%; max-width: 600px; padding: 15px; border-radius: 30px; border: 1px solid #ccc; outline: none; }
        .wrapper { display: flex; min-height: 80vh; }
        .sidebar { width: 250px; padding: 20px; border-right: 1px solid #eee; }
        .main { flex: 1; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
        .card { border: 1px solid #eee; cursor: pointer; transition: 0.2s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .card img { width: 100%; height: 180px; object-fit: cover; }
        .card-info { padding: 10px; text-align: center; font-size: 13px; font-weight: bold; }
        
        /* Bekleme Ekranı */
        #timer-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 999; display: none; flex-direction: column; align-items: center; justify-content: center; }
        #countdown { font-size: 80px; font-weight: 900; margin: 20px; }
        .ad-placeholder { background: #f0f0f0; width: 300px; height: 250px; display: flex; align-items: center; justify-content: center; color: #999; border: 1px dashed #ccc; }
        
        /* Detay Sayfası */
        #detail-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 500; display: none; overflow-y: auto; }
        .detail-content { max-width: 1000px; margin: 50px auto; display: grid; grid-template-columns: 1fr 300px; gap: 30px; padding: 20px; }
        .dl-btn { background: #000; color: #fff; width: 100%; padding: 20px; border: none; font-weight: bold; cursor: pointer; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="header">
    <a href="index.html" class="logo">FREE VECTOR STOCK</a>
</div>

<div class="search-container">
    <input type="text" id="q" placeholder="Search premium vectors..." onkeyup="doSearch()">
</div>

<div class="wrapper">
    <div class="sidebar">
        <h3 style="font-size:12px; color:#999;">CATEGORIES</h3>
        <div id="cats"></div>
    </div>
    <div class="main">
        <div class="grid" id="mainGrid"></div>
    </div>
</div>

<div id="detail-modal">
    <div style="padding: 20px;"><button onclick="closeModal()">← BACK</button></div>
    <div class="detail-content">
        <div>
            <img id="detImg" style="width: 100%;">
            <h1 id="detTitle"></h1>
            <p id="detDesc"></p>
        </div>
        <div>
            <div class="ad-placeholder">ADVERTISEMENT</div>
            <button class="dl-btn" onclick="startWait('jpg')">DOWNLOAD JPG</button>
            <button class="dl-btn" onclick="startWait('eps')">DOWNLOAD EPS (VECTOR)</button>
            <button class="dl-btn" onclick="startWait('svg')">DOWNLOAD SVG</button>
        </div>
    </div>
</div>

<div id="timer-screen">
    <div class="ad-placeholder">HIGH VALUE AD</div>
    <h2>Generating your download link...</h2>
    <div id="countdown">10</div>
    <p>Please wait, your file is being prepared.</p>
</div>

<script>
    const USER = "free-vector-stock", REPO = "free-vector-stock";
    let db = [], filtered = [], currentItem = null;

    async function load() {
        // Doğrudan GitHub API'den dosyaları çekiyoruz (Cache sorununu aşar)
        const res = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/assets?t=${Date.now()}`);
        const files = await res.json();
        const map = {};
        
        files.forEach(f => {
            const name = f.name.split('.');
            const ext = name.pop().toLowerCase();
            const id = name.join('.');
            if(!map[id]) map[id] = { id };
            map[id][ext] = f.download_url;
        });

        db = Object.values(map).filter(i => i.jpg);
        filtered = [...db];
        render();
    }

    function render() {
        const grid = document.getElementById('mainGrid');
        grid.innerHTML = filtered.map(i => `
            <div class="card" onclick="openItem('${i.id}')">
                <img src="${i.jpg}">
                <div class="card-info">${i.id.toUpperCase()}</div>
            </div>
        `).join('');
    }

    function openItem(id) {
        currentItem = db.find(i => i.id === id);
        document.getElementById('detImg').src = currentItem.jpg;
        document.getElementById('detTitle').innerText = id.replace(/-/g, ' ');
        document.getElementById('detail-modal').style.display = 'block';
    }

    function closeModal() { document.getElementById('detail-modal').style.display = 'none'; }

    function startWait(type) {
        const url = currentItem[type];
        if(!url) return alert("Format not found!");
        
        const screen = document.getElementById('timer-screen');
        const count = document.getElementById('countdown');
        screen.style.display = 'flex';
        let sec = 10;
        
        const timer = setInterval(() => {
            sec--;
            count.innerText = sec;
            if(sec <= 0) {
                clearInterval(timer);
                screen.style.display = 'none';
                const a = document.createElement('a');
                a.href = url;
                a.download = `${currentItem.id}.${type}`;
                a.click();
            }
        }, 1000);
    }

    function doSearch() {
        const val = document.getElementById('q').value.toLowerCase();
        filtered = db.filter(i => i.id.toLowerCase().includes(val));
        render();
    }

    load();
</script>
</body>
</html>
