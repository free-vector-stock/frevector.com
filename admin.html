<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ADMIN - FREE VECTOR STOCK</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body{font-family:'Segoe UI',Arial,sans-serif;background:#f0f2f5;margin:0;display:flex;justify-content:center;align-items:center;min-height:100vh}
        .container{background:#fff;padding:40px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.1);width:100%;max-width:600px}
        h2{text-align:center;margin-bottom:25px;color:#1a1a1a;border-bottom:2px solid #000;padding-bottom:10px}
        input,button{width:100%;padding:14px;margin-bottom:15px;border:1px solid #ddd;border-radius:6px;box-sizing:border-box}
        button{background:#000;color:#fff;font-weight:bold;cursor:pointer;border:none;transition:0.3s}
        button:hover{background:#333}
        #status{max-height:250px;overflow-y:auto;background:#fafafa;padding:15px;border-radius:6px;font-size:12px;border:1px solid #eee}
        .success{color:#27ae60;font-weight:bold} .error{color:#e74c3c;font-weight:bold}
        .info{font-size:11px;color:#666;text-align:center;margin-bottom:10px}
    </style>
</head>
<body>
    <div class="container">
        <h2>STOCK MULTI-UPLOAD PANEL</h2>
        <p class="info">Select JPG, ZIP, and JSON files with identical names together.</p>
        <input type="password" id="token" placeholder="GitHub Personal Access Token">
        <input type="file" id="fileInput" multiple>
        <button onclick="startUpload()">START MULTI-UPLOAD</button>
        <div id="status">Ready...</div>
    </div>

<script>
const repo = "free-vector-stock/free-vector-stock";
const cats = ["Abstract","Animals/Wildlife","The Arts","Backgrounds/Textures","Beauty/Fashion","Buildings/Landmarks","Business/Finance","Celebrities","Education","Food","Drink","Healthcare/Medical","Holidays","Industrial","Interiors","Miscellaneous","Nature","Objects","Parks/Outdoor","People","Religion","Science","Signs/Symbols","Sports/Recreation","Technology","Transportation","Vintage","Logo","Font","Icon"];

function getCat(filename){
    let prefix = filename.split('-')[0].toLowerCase();
    let found = cats.find(c => c.toLowerCase().replace(/[^a-z]/g,"").includes(prefix));
    return found || "Miscellaneous";
}

async function startUpload() {
    const token = document.getElementById('token').value;
    const files = document.getElementById('fileInput').files;
    const status = document.getElementById('status');
    
    if(!token || files.length === 0) { alert("Token and files required!"); return; }
    status.innerHTML = "Starting upload process...<br>";

    for (let file of files) {
        const cat = getCat(file.name);
        const path = `assets/${cat}/${file.name}`;
        
        try {
            const content = await toBase64(file);
            const sha = await getSha(path, token);
            
            const res = await fetch(`https://api.github.com/repos/${repo}/contents/${path}`, {
                method: "PUT",
                headers: { 
                    "Authorization": `token ${token}`, 
                    "Content-Type": "application/json",
                    "Accept": "application/vnd.github.v3+json"
                },
                body: JSON.stringify({
                    message: `Upload ${file.name} to ${cat}`,
                    content: content,
                    sha: sha || undefined
                })
            });

            if(res.ok) {
                status.innerHTML += `<div class="success">Uploaded: ${file.name} to ${cat}</div>`;
            } else {
                const errData = await res.json();
                throw new Error(errData.message || "Upload failed");
            }
        } catch (e) {
            status.innerHTML += `<div class="error">Failed: ${file.name} (${e.message})</div>`;
        }
        status.scrollTop = status.scrollHeight;
    }
}

const toBase64 = file => new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => resolve(reader.result.split(',')[1]);
    reader.onerror = error => reject(error);
});

async function getSha(path, token) {
    try {
        const res = await fetch(`https://api.github.com/repos/${repo}/contents/${path}`, {
            headers: { "Authorization": `token ${token}` }
        });
        if (res.ok) { 
            const data = await res.json(); 
            return data.sha; 
        }
    } catch (e) {}
    return null;
}
</script>
</body>
</html>
