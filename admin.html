<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN PANEL - FREE VECTOR STOCK</title>
    <style>
        :root { --primary: #000; --bg: #f4f4f4; --white: #fff; }
        body { margin: 0; font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); color: var(--primary); }
        .header { background: var(--primary); color: var(--white); padding: 20px; text-align: center; font-weight: bold; font-size: 20px; }
        .container { max-width: 800px; margin: 40px auto; background: var(--white); padding: 40px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .section { margin-bottom: 25px; }
        label { display: block; margin-bottom: 10px; font-weight: 600; }
        input[type="password"] { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        .upload-zone { border: 3px dashed #ccc; padding: 60px; text-align: center; border-radius: 10px; cursor: pointer; background: #fafafa; transition: 0.3s; }
        .upload-zone:hover { border-color: var(--primary); background: var(--white); }
        #fileStatus { margin-top: 20px; font-size: 13px; color: #555; max-height: 200px; overflow-y: auto; background: #f9f9f9; padding: 15px; border-radius: 6px; display: none; }
        .btn { background: var(--primary); color: var(--white); width: 100%; padding: 18px; border: none; border-radius: 8px; font-weight: bold; font-size: 16px; cursor: pointer; transition: 0.3s; }
        .btn:disabled { background: #999; cursor: not-allowed; }
        .status-msg { margin-top: 20px; padding: 15px; border-radius: 8px; text-align: center; font-weight: bold; display: none; }
        .loading { background: #fff3cd; color: #856404; }
        .success { background: #d4edda; color: #155724; }
    </style>
</head>
<body>

<div class="header">FREE VECTOR STOCK - CLOUD MANAGEMENT SYSTEM</div>

<div class="container">
    <div class="section">
        <label>Authentication Token (GitHub PAT):</label>
        <input type="password" id="ghToken" placeholder="Enter your ghp_... token here">
    </div>

    <div class="section">
        <div class="upload-zone" onclick="document.getElementById('fileInput').click()">
            <strong>DRAG & DROP OR CLICK TO BULK UPLOAD</strong>
            <p>Upload JPG, EPS10, SVG and JSON files simultaneously. The system will pair them by name.</p>
        </div>
        <input type="file" id="fileInput" multiple style="display:none" onchange="processFiles(this.files)">
    </div>

    <div id="fileStatus"></div>
    <div id="msgBox" class="status-msg"></div>
    
    <button id="uploadBtn" class="btn" onclick="startUpload()" disabled>SYNC ALL TO GITHUB CLOUD</button>
</div>

<script>
    const CONFIG = { owner: "free-vector-stock", repo: "free-vector-stock" };
    let uploadQueue = [];

    function processFiles(files) {
        uploadQueue = Array.from(files);
        const status = document.getElementById('fileStatus');
        if(uploadQueue.length > 0) {
            status.style.display = "block";
            status.innerHTML = "<strong>Ready for Cloud Sync:</strong><br>" + 
                               uploadQueue.map(f => `â€¢ ${f.name}`).join('<br>');
            document.getElementById('uploadBtn').disabled = false;
        }
    }

    async function startUpload() {
        const token = document.getElementById('ghToken').value.trim();
        const msg = document.getElementById('msgBox');
        const btn = document.getElementById('uploadBtn');

        if(!token) return alert("Please enter your GitHub Token.");

        msg.className = "status-msg loading";
        msg.style.display = "block";
        msg.innerText = "Connecting to GitHub API... Encrypting and uploading files.";
        btn.disabled = true;

        try {
            for (let file of uploadQueue) {
                const base64Content = await new Promise(r => {
                    const reader = new FileReader();
                    reader.onload = () => r(reader.result.split(',')[1]);
                    reader.readAsDataURL(file);
                });

                const url = `https://api.github.com/repos/${CONFIG.owner}/${CONFIG.repo}/contents/assets/${file.name}`;
                const check = await fetch(url, { headers: { 'Authorization': `token ${token}` } });
                let sha = null;
                if (check.ok) { const data = await check.json(); sha = data.sha; }

                const res = await fetch(url, {
                    method: 'PUT',
                    headers: { 'Authorization': `token ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: `Admin Upload: ${file.name}`, content: base64Content, sha: sha })
                });
                if(!res.ok) throw new Error(`Failed to upload ${file.name}`);
            }
            msg.className = "status-msg success";
            msg.innerText = "SUCCESS! All assets have been synced to the GitHub Repository.";
        } catch (e) {
            alert("Error: " + e.message);
            btn.disabled = false;
        }
    }
</script>
</body>
</html>
