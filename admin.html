<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ADMIN - FREE VECTOR STOCK</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body{font-family:Arial,sans-serif;background:#fff;margin:0;padding:40px;display:flex;justify-content:center}
        .upload-card{width:100%;max-width:500px;border:1px solid #eee;padding:30px;box-shadow:0 10px 30px rgba(0,0,0,0.05)}
        h2{margin-top:0;font-size:18px;border-bottom:2px solid #000;padding-bottom:10px}
        input,button{width:100%;padding:12px;margin-top:15px;box-sizing:border-box;border:1px solid #ddd}
        button{background:#000;color:#fff;font-weight:bold;cursor:pointer;border:none}
        button:hover{background:#333}
        #status{margin-top:20px;font-size:12px;max-height:150px;overflow-y:auto;padding:10px;background:#f9f9f9}
        .ok{color:green} .err{color:red}
    </style>
</head>
<body>

<div class="upload-card">
    <h2>STOCK UPLOAD PANEL</h2>
    <p style="font-size:11px;color:#666">Select JPG, ZIP, and JSON files together (Identical names required).</p>
    <input type="password" id="token" placeholder="Enter GitHub Personal Access Token">
    <input type="file" id="files" multiple>
    <button onclick="handleUpload()">UPLOAD ALL FILES</button>
    <div id="status"></div>
</div>

<script>
const repo="free-vector-stock/free-vector-stock";
const categories=["Abstract","Animals/Wildlife","The Arts","Backgrounds/Textures","Beauty/Fashion","Buildings/Landmarks","Business/Finance","Celebrities","Education","Food","Drink","Healthcare/Medical","Holidays","Industrial","Interiors","Miscellaneous","Nature","Objects","Parks/Outdoor","People","Religion","Science","Signs/Symbols","Sports/Recreation","Technology","Transportation","Vintage","Logo","Font","Icon"];

function findCategory(name){
    let p=name.split("-")[0].toLowerCase();
    return categories.find(c=>c.toLowerCase().replace(/[^a-z]/g,"").includes(p))||"Miscellaneous";
}

async function handleUpload(){
    const t=document.getElementById("token").value;
    const f=document.getElementById("files").files;
    const s=document.getElementById("status");
    if(!t||f.length===0){alert("Token and files are mandatory!");return;}

    for(let file of f){
        let cat=findCategory(file.name);
        let path=`assets/${cat}/${file.name}`;
        let reader=new FileReader();
        reader.onload=async(e)=>{
            let content=e.target.result.split(",")[1];
            let url=`https://api.github.com/repos/${repo}/contents/${path}`;
            let sha="";
            let check=await fetch(url,{headers:{Authorization:`token ${t}`}});
            if(check.ok){let res=await check.json();sha=res.sha;}

            let res=await fetch(url,{
                method:"PUT",
                headers:{Authorization:`token ${t}`,"Content-Type":"application/json"},
                body:JSON.stringify({message:`Upload ${file.name}`,content:content,sha:sha||undefined})
            });
            if(res.ok) s.innerHTML+=`<div class="ok">✓ ${file.name} -> ${cat}</div>`;
            else s.innerHTML+=`<div class="err">✗ Error: ${file.name}</div>`;
        };
        reader.readAsDataURL(file);
    }
}
</script>
</body>
</html>
