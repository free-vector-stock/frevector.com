<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ADMIN PANEL</title>
    <style>
        body { font-family: sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; background: #f4f4f4; }
        .box { background: #fff; padding: 40px; border-radius: 10px; width: 500px; text-align: center; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .drop-zone { border: 2px dashed #ccc; padding: 30px; margin: 20px 0; cursor: pointer; }
        input { width: 100%; padding: 10px; margin-bottom: 10px; }
        button { width: 100%; padding: 15px; background: #000; color: #fff; border: none; cursor: pointer; font-weight: bold; }
        #status { margin-top: 15px; font-size: 12px; color: green; }
    </style>
</head>
<body>
    <div class="box">
        <h2>GITHUB CLOUD UPLOADER</h2>
        <input type="password" id="token" placeholder="Enter GitHub Token">
        <div class="drop-zone" onclick="document.getElementById('f').click()">
            Click to Select Multiple Files (JPG, EPS, SVG)
        </div>
        <input type="file" id="f" multiple style="display:none" onchange="showCount()">
        <div id="status"></div>
        <button onclick="upload()">SYNC TO CLOUD</button>
    </div>

    <script>
        function showCount() {
            document.getElementById('status').innerText = document.getElementById('f').files.length + " files selected.";
        }

        async function upload() {
            const token = document.getElementById('token').value;
            const files = document.getElementById('f').files;
            const status = document.getElementById('status');
            const USER = "free-vector-stock", REPO = "free-vector-stock";

            if(!token || files.length === 0) return alert("Token and files required!");

            for(let file of files) {
                status.innerText = "Uploading: " + file.name;
                const reader = new FileReader();
                reader.readAsDataURL(file);
                await new Promise(resolve => {
                    reader.onload = async () => {
                        const base64 = reader.result.split(',')[1];
                        const path = `assets/${file.name}`;
                        
                        // Önce dosya var mı kontrol et (SHA al)
                        let sha = null;
                        const check = await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${path}`, {
                            headers: { 'Authorization': `token ${token}` }
                        });
                        if(check.ok) { const data = await check.json(); sha = data.sha; }

                        // Yükle veya Güncelle
                        await fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${path}`, {
                            method: 'PUT',
                            headers: { 'Authorization': `token ${token}`, 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                message: "Cloud Update",
                                content: base64,
                                sha: sha
                            })
                        });
                        resolve();
                    };
                });
            }
            status.innerText = "SUCCESS! All files synced. Please wait 1 minute for GitHub to refresh.";
        }
    </script>
</body>
</html>
